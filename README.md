flask-video-streaming-opencv-google-colab
=====================
This fork uses **flask-video-streaming** and **ngrok** to implement the functionality of the cv2.imshow function of opencv in Google Colab. Although there are alternatives such as **matplotlib.pyplot.imshow()** and **google.colab.patches.cv2_imshow()**, these functions are not adequate to show video. The functionality implemented allows to show a video  in a public IP generated by **ngrok**.

Installation
------------
1. Open google colaboratory
2. clone this repository: 
```!git clone https://github.com/roggerfq/flask-video-streaming-opencv-google-colab.git```
3. Install requirements: 
```!pip install -r /content/flask-video-streaming-opencv-google-colab/requirements-google-colab.txt```

Basic example
----------------------------
Before running the example download a test video from my Drive: 
```python
import gdown
url = 'https://drive.google.com/uc?id=17qVBraVTJ52Ot_sphLEwh8046hMRIyRa'
output = 'cat.mp4'
gdown.download(url, output, quiet=False)
```
Now run the following code and open the URL generated by ngrok:
```python
import sys
sys.path.append("/content/flask-video-streaming-opencv-google-colab")
from web_imshow import WebWindow
import cv2

webWindow = WebWindow()

cap = cv2.VideoCapture('/content/cat.mp4')
_, img = cap.read()
#percent by which the image is resized
scale_percent = 90
#calculate the percent of original dimensions
width = int(img.shape[1] * scale_percent / 100)
height = int(img.shape[0] * scale_percent / 100)
# dsize
dsize = (width, height)

while(True):
    ret, img = cap.read()
    if ret == True:
       img = cv2.resize(img, dsize)
       webWindow.imshow(img)
    else:
       break

webWindow.close()
```

Run this code in [Google Colab](https://colab.research.google.com/drive/104zo40yNTVK6s_HDGW8OiUfI6uMO6FuT?usp=sharing)

Result
------------
![alt text](https://raw.githubusercontent.com/roggerfq/flask-video-streaming-opencv-google-colab/master/result.png)

Supporting code for my article [video streaming with Flask](http://blog.miguelgrinberg.com/post/video-streaming-with-flask) and its follow-up [Flask Video Streaming Revisited](http://blog.miguelgrinberg.com/post/flask-video-streaming-revisited).
